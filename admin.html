<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Smart Canteen - Admin Dashboard</title>
    <link rel="stylesheet" href="styles.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
    <nav class="navbar">
        <div class="nav-container">
            <h1 class="nav-logo">Smart Canteen Admin</h1>
            <div class="nav-menu">
                <div class="user-info">
                    <span id="adminName">Welcome, Admin</span>
                    <button onclick="logout()" class="btn btn-small">Logout</button>
                </div>
            </div>
        </div>
    </nav>

    <main class="main-content">
        <div id="notification" class="notification hidden"></div>
        
        <div class="admin-tabs">
            <button class="tab-button active" onclick="showTab('dashboard')">Dashboard</button>
            <button class="tab-button" onclick="showTab('menu')">Menu Management</button>
            <button class="tab-button" onclick="showTab('orders')">Order Management</button>
            <button class="tab-button" onclick="showTab('analytics')">Analytics</button>
        </div>

        
        <div id="dashboard" class="tab-content active">
            <div class="dashboard-stats">
                <div class="stat-card">
                    <h3>Total Users</h3>
                    <div class="stat-number" id="totalUsers">0</div>
                </div>
                <div class="stat-card">
                    <h3>Total Orders</h3>
                    <div class="stat-number" id="totalOrders">0</div>
                </div>
                <div class="stat-card">
                    <h3>Total Revenue</h3>
                    <div class="stat-number">₹<span id="totalRevenue">0.00</span></div>
                </div>
                <div class="stat-card">
                    <h3>Pending Orders</h3>
                    <div class="stat-number" id="pendingOrders">0</div>
                </div>
            </div>
            
            <div class="dashboard-recent">
                <div class="recent-orders">
                    <h3>Recent Orders</h3>
                    <div class="recent-orders-list" id="recentOrdersList">
                        
                    </div>
                </div>
                
                <div class="quick-stats">
                    <h3>Quick Stats</h3>
                    <div class="quick-stat-item">
                        <span>Available Menu Items:</span>
                        <span id="availableItems">0</span>
                    </div>
                    <div class="quick-stat-item">
                        <span>Unavailable Menu Items:</span>
                        <span id="unavailableItems">0</span>
                    </div>
                    <div class="quick-stat-item">
                        <span>Orders Today:</span>
                        <span id="ordersToday">0</span>
                    </div>
                    <div class="quick-stat-item">
                        <span>Revenue Today:</span>
                        <span>₹<span id="revenueToday">0.00</span></span>
                    </div>
                </div>
            </div>
        </div>

        
        <div id="menu" class="tab-content">
            <div class="menu-management">
                <div class="menu-header">
                    <h2>Menu Management</h2>
                    <button onclick="showAddItemForm()" class="btn btn-primary">Add New Item</button>
                </div>
                
                
                <div id="itemFormContainer" class="form-container hidden">
                    <div class="form-card">
                        <h3 id="formTitle">Add New Menu Item</h3>
                        <form id="menuItemForm">
                            <input type="hidden" id="editItemId">
                            
                            <div class="form-group">
                                <label for="itemName">Item Name</label>
                                <input type="text" id="itemName" required>
                            </div>
                            
                            <div class="form-group">
                                <label for="itemDescription">Description</label>
                                <textarea id="itemDescription" rows="3"></textarea>
                            </div>
                            
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="itemPrice">Price (₹)</label>
                                    <input type="number" id="itemPrice" step="0.01" min="0" required>
                                </div>
                                
                                <div class="form-group">
                                    <label for="itemCategory">Category</label>
                                    <select id="itemCategory" required>
                                        <option value="">Select Category</option>
                                        <option value="Main Course">Main Course</option>
                                        <option value="Snacks">Snacks</option>
                                        <option value="Beverages">Beverages</option>
                                        <option value="Breakfast">Breakfast</option>
                                        <option value="Desserts">Desserts</option>
                                    </select>
                                </div>
                            </div>
                            
                            <div class="form-group">
                                <label>
                                    <input type="checkbox" id="itemAvailability" checked>
                                    Available for ordering
                                </label>
                            </div>
                            
                            <div class="form-actions">
                                <button type="button" onclick="cancelItemForm()" class="btn btn-secondary">Cancel</button>
                                <button type="submit" class="btn btn-primary">Save Item</button>
                            </div>
                        </form>
                    </div>
                </div>
                
                
                <div class="table-container">
                    <table class="table">
                        <thead>
                            <tr>
                                <th>ID</th>
                                <th>Name</th>
                                <th>Category</th>
                                <th>Price</th>
                                <th>Available</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="menuTableBody">
                            
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        
        <div id="orders" class="tab-content">
            <div class="order-management">
                <div class="order-header">
                    <h2>Order Management</h2>
                    <div class="order-filters">
                        <select id="orderStatusFilter" onchange="filterOrders()">
                            <option value="">All Orders</option>
                            <option value="Uncompleted">Uncompleted</option>
                            <option value="Ready">Ready</option>
                            <option value="Completed">Completed</option>
                        </select>
                        <input type="text" id="orderSearchInput" placeholder="Search by Order ID or Customer" oninput="filterOrders()">
                    </div>
                </div>
                
                <div class="table-container">
                    <table class="table">
                        <thead>
                            <tr>
                                <th>Order ID</th>
                                <th>Customer</th>
                                <th>Items</th>
                                <th>Total</th>
                                <th>Status</th>
                                <th>Time</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="ordersTableBody">
                            
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        
        <div id="analytics" class="tab-content">
            <div class="analytics-dashboard">
                <h2>Analytics Dashboard</h2>
                
                <div class="analytics-section">
                    <div class="chart-container">
                        <h3>Revenue Trend (Last 7 Days)</h3>
                        <canvas id="revenueChart"></canvas>
                    </div>
                    
                    <div class="chart-container">
                        <h3>Most Popular Items</h3>
                        <canvas id="popularItemsChart"></canvas>
                    </div>
                </div>
                
                <div class="analytics-section">
                    <div class="chart-container">
                        <h3>Orders by Status</h3>
                        <canvas id="orderStatusChart"></canvas>
                    </div>
                    
                    <div class="analytics-stats">
                        <h3>Performance Metrics</h3>
                        <div class="metric-item">
                            <span class="metric-label">Average Order Value:</span>
                            <span class="metric-value">₹<span id="avgOrderValue">0.00</span></span>
                        </div>
                        <div class="metric-item">
                            <span class="metric-label">Orders per Day:</span>
                            <span class="metric-value" id="ordersPerDay">0</span>
                        </div>
                        <div class="metric-item">
                            <span class="metric-label">Most Active Hour:</span>
                            <span class="metric-value" id="mostActiveHour">-</span>
                        </div>
                        <div class="metric-item">
                            <span class="metric-label">Customer Retention:</span>
                            <span class="metric-value" id="customerRetention">0%</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>

    
    <div id="orderDetailsModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Order Details</h3>
                <span class="close" onclick="closeOrderDetailsModal()">&times;</span>
            </div>
            <div class="modal-body" id="orderDetailsContent">
                
            </div>
        </div>
    </div>

    <script src="app.js"></script>
    <script>
        // Check authentication
        const currentUser = getCurrentUser();
        if (!currentUser) {
            window.location.href = 'login.html';
        } else if (currentUser.role !== 'admin') {
            window.location.href = 'user_dashboard.html';
        }
        
        let revenueChart, popularItemsChart, orderStatusChart;
        
        // Initialize page
        document.addEventListener('DOMContentLoaded', function() {
            document.getElementById('adminName').textContent = `Welcome, ${currentUser.username}`;
            loadDashboardStats();
            loadMenuItems();
            loadOrders();
            initializeCharts();
            startNotificationPolling();
        });
        
        function showTab(tabName) {
            // Hide all tab contents
            const tabContents = document.querySelectorAll('.tab-content');
            tabContents.forEach(tab => tab.classList.remove('active'));
            
            // Remove active class from all tab buttons
            const tabButtons = document.querySelectorAll('.tab-button');
            tabButtons.forEach(button => button.classList.remove('active'));
            
            // Show selected tab
            document.getElementById(tabName).classList.add('active');
            event.target.classList.add('active');
            
            // Load specific data based on tab
            if (tabName === 'dashboard') {
                loadDashboardStats();
            } else if (tabName === 'menu') {
                loadMenuItems();
            } else if (tabName === 'orders') {
                loadOrders();
            } else if (tabName === 'analytics') {
                loadAnalytics();
            }
        }
        
        function loadDashboardStats() {
            const users = getAllUsers();
            const orders = getAllOrders();
            const menu = getMenu();
            
            // Calculate stats
            const totalUsers = users.filter(user => user.role === 'user').length;
            const totalOrders = orders.length;
            const totalRevenue = orders.reduce((sum, order) => sum + order.total_amount, 0);
            const pendingOrders = orders.filter(order => order.status === 'Uncompleted').length;
            
            const today = new Date().toDateString();
            const ordersToday = orders.filter(order => new Date(order.timestamp).toDateString() === today);
            const revenueToday = ordersToday.reduce((sum, order) => sum + order.total_amount, 0);
            
            const availableItems = menu.filter(item => item.availability).length;
            const unavailableItems = menu.filter(item => !item.availability).length;
            
            // Update UI
            document.getElementById('totalUsers').textContent = totalUsers;
            document.getElementById('totalOrders').textContent = totalOrders;
            document.getElementById('totalRevenue').textContent = totalRevenue.toFixed(2);
            document.getElementById('pendingOrders').textContent = pendingOrders;
            document.getElementById('ordersToday').textContent = ordersToday.length;
            document.getElementById('revenueToday').textContent = revenueToday.toFixed(2);
            document.getElementById('availableItems').textContent = availableItems;
            document.getElementById('unavailableItems').textContent = unavailableItems;
            
            // Load recent orders
            const recentOrders = orders.slice(0, 5).sort((a, b) => new Date(b.timestamp) - new Date(a.timestamp));
            const recentOrdersList = document.getElementById('recentOrdersList');
            
            recentOrdersList.innerHTML = recentOrders.map(order => `
                <div class="recent-order-item">
                    <div class="order-info">
                        <strong>${order.order_id}</strong>
                        <span class="order-customer">${getUserById(order.user_id)?.username || 'Unknown'}</span>
                    </div>
                    <div class="order-details">
                        <span class="order-amount">₹${order.total_amount.toFixed(2)}</span>
                        <span class="order-status status-${order.status.toLowerCase()}">${order.status}</span>
                    </div>
                </div>
            `).join('');
        }
        
        function loadMenuItems() {
            const menu = getMenu();
            const menuTableBody = document.getElementById('menuTableBody');
            
            menuTableBody.innerHTML = menu.map(item => `
                <tr>
                    <td>${item.id}</td>
                    <td>${item.item_name}</td>
                    <td>${item.category}</td>
                    <td>₹${item.price.toFixed(2)}</td>
                    <td>
                        <span class="availability-badge ${item.availability ? 'available' : 'unavailable'}">
                            ${item.availability ? 'Available' : 'Unavailable'}
                        </span>
                    </td>
                    <td>
                        <button onclick="editMenuItem(${item.id})" class="btn btn-small">Edit</button>
                        <button onclick="toggleAvailability(${item.id})" class="btn btn-small btn-secondary">
                            ${item.availability ? 'Disable' : 'Enable'}
                        </button>
                        <button onclick="deleteMenuItem(${item.id})" class="btn btn-small btn-danger">Delete</button>
                    </td>
                </tr>
            `).join('');
        }
        
        function loadOrders() {
            const orders = getAllOrders();
            const statusFilter = document.getElementById('orderStatusFilter').value;
            const searchTerm = document.getElementById('orderSearchInput').value.toLowerCase();
            
            let filteredOrders = orders;
            
            if (statusFilter) {
                filteredOrders = filteredOrders.filter(order => order.status === statusFilter);
            }
            
            if (searchTerm) {
                filteredOrders = filteredOrders.filter(order => 
                    order.order_id.toLowerCase().includes(searchTerm) ||
                    (getUserById(order.user_id)?.username || '').toLowerCase().includes(searchTerm)
                );
            }
            
            const ordersTableBody = document.getElementById('ordersTableBody');
            
            ordersTableBody.innerHTML = filteredOrders.map(order => {
                const customer = getUserById(order.user_id);
                return `
                    <tr>
                        <td>${order.order_id}</td>
                        <td>${customer?.username || 'Unknown'}</td>
                        <td>${order.items.length} items</td>
                        <td>₹${order.total_amount.toFixed(2)}</td>
                        <td>
                            <select onchange="updateOrderStatus('${order.order_id}', this.value)" class="status-select">
                                <option value="Uncompleted" ${order.status === 'Uncompleted' ? 'selected' : ''}>Uncompleted</option>
                                <option value="Ready" ${order.status === 'Ready' ? 'selected' : ''}>Ready</option>
                                <option value="Completed" ${order.status === 'Completed' ? 'selected' : ''}>Completed</option>
                            </select>
                        </td>
                        <td>${new Date(order.timestamp).toLocaleString()}</td>
                        <td>
                            <button onclick="viewOrderDetails('${order.order_id}')" class="btn btn-small">View</button>
                        </td>
                    </tr>
                `;
            }).join('');
        }
        
        function filterOrders() {
            loadOrders();
        }
        
        function showAddItemForm() {
            document.getElementById('formTitle').textContent = 'Add New Menu Item';
            document.getElementById('editItemId').value = '';
            document.getElementById('menuItemForm').reset();
            document.getElementById('itemAvailability').checked = true;
            document.getElementById('itemFormContainer').classList.remove('hidden');
        }
        
        function cancelItemForm() {
            document.getElementById('itemFormContainer').classList.add('hidden');
        }
        
        function editMenuItem(itemId) {
            const menu = getMenu();
            const item = menu.find(i => i.id === itemId);
            
            if (!item) return;
            
            document.getElementById('formTitle').textContent = 'Edit Menu Item';
            document.getElementById('editItemId').value = itemId;
            document.getElementById('itemName').value = item.item_name;
            document.getElementById('itemDescription').value = item.description;
            document.getElementById('itemPrice').value = item.price;
            document.getElementById('itemCategory').value = item.category;
            document.getElementById('itemAvailability').checked = item.availability;
            document.getElementById('itemFormContainer').classList.remove('hidden');
        }
        
        function deleteMenuItem(itemId) {
            if (confirm('Are you sure you want to delete this menu item?')) {
                const result = deleteMenuItemById(itemId);
                if (result.success) {
                    showNotification('Menu item deleted successfully', 'success');
                    loadMenuItems();
                    loadDashboardStats();
                } else {
                    showNotification(result.message, 'error');
                }
            }
        }
        
        function toggleAvailability(itemId) {
            const result = toggleMenuItemAvailability(itemId);
            if (result.success) {
                showNotification('Availability updated successfully', 'success');
                loadMenuItems();
                loadDashboardStats();
            } else {
                showNotification(result.message, 'error');
            }
        }
        
        function updateOrderStatus(orderId, newStatus) {
            const result = updateOrderStatusById(orderId, newStatus);
            if (result.success) {
                showNotification(`Order ${orderId} status updated to ${newStatus}`, 'success');
                loadOrders();
                loadDashboardStats();
            } else {
                showNotification(result.message, 'error');
            }
        }
        
        function viewOrderDetails(orderId) {
            const orders = getAllOrders();
            const order = orders.find(o => o.order_id === orderId);
            
            if (!order) {
                showNotification('Order not found', 'error');
                return;
            }
            
            const customer = getUserById(order.user_id);
            
            document.getElementById('orderDetailsContent').innerHTML = `
                <div class="order-detail-info">
                    <div class="detail-row">
                        <span class="label">Order ID:</span>
                        <span class="value">${order.order_id}</span>
                    </div>
                    <div class="detail-row">
                        <span class="label">Customer:</span>
                        <span class="value">${customer?.username || 'Unknown'}</span>
                    </div>
                    <div class="detail-row">
                        <span class="label">Email:</span>
                        <span class="value">${customer?.email || 'Unknown'}</span>
                    </div>
                    <div class="detail-row">
                        <span class="label">Order Time:</span>
                        <span class="value">${new Date(order.timestamp).toLocaleString()}</span>
                    </div>
                    <div class="detail-row">
                        <span class="label">Payment Method:</span>
                        <span class="value">${order.payment_method}</span>
                    </div>
                    <div class="detail-row">
                        <span class="label">Transaction ID:</span>
                        <span class="value">${order.transaction_id}</span>
                    </div>
                    <div class="detail-row">
                        <span class="label">Status:</span>
                        <span class="value status-${order.status.toLowerCase()}">${order.status}</span>
                    </div>
                </div>
                
                <div class="order-items-detail">
                    <h4>Items Ordered:</h4>
                    <div class="items-list">
                        ${order.items.map(item => `
                            <div class="item-detail">
                                <div class="item-info">
                                    <h5>${item.name}</h5>
                                    <p>₹${item.price.toFixed(2)} × ${item.quantity}</p>
                                </div>
                                <div class="item-total">
                                    ₹${(item.price * item.quantity).toFixed(2)}
                                </div>
                            </div>
                        `).join('')}
                    </div>
                    <div class="order-total-detail">
                        <strong>Total: ₹${order.total_amount.toFixed(2)}</strong>
                    </div>
                </div>
            `;
            
            document.getElementById('orderDetailsModal').style.display = 'block';
        }
        
        function closeOrderDetailsModal() {
            document.getElementById('orderDetailsModal').style.display = 'none';
        }
        
        function initializeCharts() {
            // Revenue Chart
            const revenueCtx = document.getElementById('revenueChart').getContext('2d');
            revenueChart = new Chart(revenueCtx, {
                type: 'line',
                data: {
                    labels: [],
                    datasets: [{
                        label: 'Revenue (₹)',
                        data: [],
                        borderColor: 'rgb(75, 192, 192)',
                        backgroundColor: 'rgba(75, 192, 192, 0.2)',
                        tension: 0.1
                    }]
                },
                options: {
                    responsive: true,
                    scales: {
                        y: {
                            beginAtZero: true
                        }
                    }
                }
            });
            
            // Popular Items Chart
            const popularCtx = document.getElementById('popularItemsChart').getContext('2d');
            popularItemsChart = new Chart(popularCtx, {
                type: 'bar',
                data: {
                    labels: [],
                    datasets: [{
                        label: 'Orders',
                        data: [],
                        backgroundColor: 'rgba(54, 162, 235, 0.8)'
                    }]
                },
                options: {
                    responsive: true,
                    indexAxis: 'y',
                    scales: {
                        x: {
                            beginAtZero: true
                        }
                    }
                }
            });
            
            // Order Status Chart
            const statusCtx = document.getElementById('orderStatusChart').getContext('2d');
            orderStatusChart = new Chart(statusCtx, {
                type: 'doughnut',
                data: {
                    labels: [],
                    datasets: [{
                        data: [],
                        backgroundColor: [
                            '#FF6384',
                            '#36A2EB',
                            '#FFCE56'
                        ]
                    }]
                },
                options: {
                    responsive: true
                }
            });
        }
        
        function loadAnalytics() {
            const orders = getAllOrders();
            
            // Revenue trend (last 7 days)
            const last7Days = [];
            const revenueData = [];
            
            for (let i = 6; i >= 0; i--) {
                const date = new Date();
                date.setDate(date.getDate() - i);
                const dateStr = date.toDateString();
                
                last7Days.push(date.toLocaleDateString());
                
                const dayRevenue = orders
                    .filter(order => new Date(order.timestamp).toDateString() === dateStr)
                    .reduce((sum, order) => sum + order.total_amount, 0);
                
                revenueData.push(dayRevenue);
            }
            
            revenueChart.data.labels = last7Days;
            revenueChart.data.datasets[0].data = revenueData;
            revenueChart.update();
            
            // Most popular items
            const itemCounts = {};
            orders.forEach(order => {
                order.items.forEach(item => {
                    itemCounts[item.name] = (itemCounts[item.name] || 0) + item.quantity;
                });
            });
            
            const sortedItems = Object.entries(itemCounts)
                .sort(([,a], [,b]) => b - a)
                .slice(0, 5);
            
            popularItemsChart.data.labels = sortedItems.map(([name]) => name);
            popularItemsChart.data.datasets[0].data = sortedItems.map(([,count]) => count);
            popularItemsChart.update();
            
            // Order status distribution
            const statusCounts = {
                'Uncompleted': 0,
                'Ready': 0,
                'Completed': 0
            };
            
            orders.forEach(order => {
                statusCounts[order.status]++;
            });
            
            orderStatusChart.data.labels = Object.keys(statusCounts);
            orderStatusChart.data.datasets[0].data = Object.values(statusCounts);
            orderStatusChart.update();
            
            // Performance metrics
            const avgOrderValue = orders.length > 0 
                ? orders.reduce((sum, order) => sum + order.total_amount, 0) / orders.length 
                : 0;
            
            const ordersPerDay = orders.length > 0 
                ? (orders.length / 7).toFixed(1) 
                : 0;
            
            // Most active hour
            const hourCounts = {};
            orders.forEach(order => {
                const hour = new Date(order.timestamp).getHours();
                hourCounts[hour] = (hourCounts[hour] || 0) + 1;
            });
            
            const mostActiveHour = Object.entries(hourCounts)
                .sort(([,a], [,b]) => b - a)[0];
            
            const customerRetention = orders.length > 0 
                ? ((orders.filter(order => 
                    orders.filter(o => o.user_id === order.user_id).length > 1
                  ).length / orders.length) * 100).toFixed(1)
                : 0;
            
            document.getElementById('avgOrderValue').textContent = avgOrderValue.toFixed(2);
            document.getElementById('ordersPerDay').textContent = ordersPerDay;
            document.getElementById('mostActiveHour').textContent = 
                mostActiveHour ? `${mostActiveHour[0]}:00 - ${parseInt(mostActiveHour[0]) + 1}:00` : '-';
            document.getElementById('customerRetention').textContent = customerRetention + '%';
        }
        
        function startNotificationPolling() {
            // Check for new orders every 30 seconds
            setInterval(() => {
                const orders = getAllOrders();
                const recentOrders = orders.filter(order => {
                    const orderTime = new Date(order.timestamp);
                    const fiveMinutesAgo = new Date(Date.now() - 5 * 60 * 1000);
                    return orderTime > fiveMinutesAgo && order.status === 'Uncompleted';
                });
                
                if (recentOrders.length > 0) {
                    const lastNotified = localStorage.getItem('lastAdminNotification');
                    const newOrders = recentOrders.filter(order => 
                        !lastNotified || new Date(order.timestamp) > new Date(lastNotified)
                    );
                    
                    newOrders.forEach(order => {
                        showNotification(`New order received: ${order.order_id}`, 'info');
                    });
                    
                    if (newOrders.length > 0) {
                        localStorage.setItem('lastAdminNotification', new Date().toISOString());
                        loadDashboardStats();
                        loadOrders();
                    }
                }
            }, 30000);
        }
        
        function showNotification(message, type) {
            const notification = document.getElementById('notification');
            notification.textContent = message;
            notification.className = `notification ${type}`;
            notification.classList.remove('hidden');
            
            setTimeout(() => {
                notification.classList.add('hidden');
            }, 5000);
        }
        
        // Form submission handler
        document.getElementById('menuItemForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const itemId = document.getElementById('editItemId').value;
            const itemData = {
                item_name: document.getElementById('itemName').value.trim(),
                description: document.getElementById('itemDescription').value.trim(),
                price: parseFloat(document.getElementById('itemPrice').value),
                category: document.getElementById('itemCategory').value,
                availability: document.getElementById('itemAvailability').checked
            };
            
            let result;
            if (itemId) {
                // Edit existing item
                result = updateMenuItem(parseInt(itemId), itemData);
            } else {
                // Add new item
                result = addMenuItem(itemData);
            }
            
            if (result.success) {
                showNotification(itemId ? 'Menu item updated successfully' : 'Menu item added successfully', 'success');
                cancelItemForm();
                loadMenuItems();
                loadDashboardStats();
            } else {
                showNotification(result.message, 'error');
            }
        });
        
        // Close modal when clicking outside
        window.onclick = function(event) {
            const modal = document.getElementById('orderDetailsModal');
            if (event.target === modal) {
                closeOrderDetailsModal();
            }
        }
    </script>
</body>
</html>
